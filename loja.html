<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Loja - MrStore</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: url('https://i.imgur.com/sI8LmKe.png') no-repeat center center fixed;
    background-size: cover;
    color: white;
    margin: 0;
    padding: 20px;
  }
  header {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  button {
    background: gold;
    border: none;
    border-radius: 6px;
    padding: 8px 15px;
    font-weight: bold;
    cursor: pointer;
  }
  h1 {
    margin-bottom: 20px;
  }
  .moedas {
    font-size: 1.2rem;
  }
  .products {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
  }
  .product {
    background: rgba(0,0,0,0.7);
    border-radius: 10px;
    padding: 15px;
    width: 220px;
    text-align: center;
  }
  .product img {
    max-width: 100%;
    border-radius: 6px;
    margin-bottom: 10px;
  }
  .product button {
    width: 100%;
  }
</style>
</head>
<body>

<header>
  <div>Olá, <span id="user-email"></span></div>
  <button id="logout-btn">Sair</button>
</header>

<h1>Loja MrStore</h1>
<div class="moedas">Você tem <strong><span id="user-coins">0</span></strong> Mrcoin</div>

<div class="products" id="products-container"></div>

<script>
  // Verifica se usuário está logado
  const loggedUser = localStorage.getItem('mrstore_logged');
  if(!loggedUser) {
    window.location.href = 'index.html';
  }

  const userEmailElem = document.getElementById('user-email');
  const userCoinsElem = document.getElementById('user-coins');
  const productsContainer = document.getElementById('products-container');
  const logoutBtn = document.getElementById('logout-btn');

  userEmailElem.textContent = loggedUser;

  // Produtos da loja
  const produtos = [
    { id: 'bola-nike', nome: 'Bola da Nike', preco: 5000, img: 'https://static.netshoes.com.br/produtos/bola-de-futebol-campo-nike-mercurial-primeira-classe-20-21-pt/fp/33d5d14078/zoom/foto1.jpg' },
    { id: 'camisa-csgo', nome: 'Camisa oficial CS:GO', preco: 10000, img: 'https://images.lojaoficial.com.br/products/32525' },
    { id: 'camisa-atletico', nome: 'Camisa Atlético Mineiro', preco: 5000, img: 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/58/Atl%C3%A9tico_MG_logo.svg/1200px-Atl%C3%A9tico_MG_logo.svg.png' }
  ];

  // Pega moedas do localStorage
  function getCoins() {
    return parseInt(localStorage.getItem('mrstore_coins_' + loggedUser)) || 0;
  }

  // Salva moedas
  function setCoins(coins) {
    localStorage.setItem('mrstore_coins_' + loggedUser, coins);
    userCoinsElem.textContent = coins;
  }

  // Inicializa moedas na tela
  setCoins(getCoins());

  // Cria lista de produtos na tela
  function mostrarProdutos() {
    productsContainer.innerHTML = '';
    produtos.forEach(prod => {
      const div = document.createElement('div');
      div.className = 'product';
      div.innerHTML = `
        <img src="${prod.img}" alt="${prod.nome}" />
        <h3>${prod.nome}</h3>
        <p>Preço: ${prod.preco} Mrcoin</p>
        <button>Comprar</button>
      `;
      const btn = div.querySelector('button');
      btn.addEventListener('click', () => comprarProduto(prod));
      productsContainer.appendChild(div);
    });
  }

  // Comprar produto
  function comprarProduto(produto) {
    let moedas = getCoins();
    if(moedas < produto.preco) {
      alert('Saldo insuficiente!');
      return;
    }
    moedas -= produto.preco;
    setCoins(moedas);

    // Salva o produto comprado no localStorage (array)
    let compras = JSON.parse(localStorage.getItem('mrstore_compras_' + loggedUser) || '[]');
    compras.push(produto.id);
    localStorage.setItem('mrstore_compras_' + loggedUser, JSON.stringify(compras));

    alert('Produto comprado com sucesso!');
  }

  logoutBtn.addEventListener('click', () => {
    localStorage.removeItem('mrstore_logged');
    window.location.href = 'index.html';
  });

  mostrarProdutos();
</script>

</body>
</html>
